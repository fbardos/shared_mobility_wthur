{
  "__inputs": [
    {
      "name": "DS_PSQL",
      "label": "psql",
      "description": "",
      "type": "datasource",
      "pluginId": "postgres",
      "pluginName": "PostgreSQL"
    },
    {
      "name": "DS_POSTGIS_SHARED_MOBILITY",
      "label": "PostGIS shared_mobility",
      "description": "",
      "type": "datasource",
      "pluginId": "postgres",
      "pluginName": "PostgreSQL"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "panel",
      "id": "geomap",
      "name": "Geomap",
      "version": ""
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "10.0.1"
    },
    {
      "type": "panel",
      "id": "histogram",
      "name": "Histogram",
      "version": ""
    },
    {
      "type": "datasource",
      "id": "postgres",
      "name": "PostgreSQL",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "text",
      "name": "Text",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    },
    {
      "type": "panel",
      "id": "vaduga-mapgl-panel",
      "name": "Mapgl",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "xychart",
      "name": "XY Chart",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 14,
      "panels": [],
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_PSQL}"
      },
      "description": "",
      "gridPos": {
        "h": 8,
        "w": 11,
        "x": 0,
        "y": 1
      },
      "id": 4,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "\n\n# E-Scooter Winterthur\n<div class=\"alert alert-warning\" role=\"alert\">\n  <p>Current status: TEST, report issues <a href=\"https://github.com/fbardos/shared_mobility_wthur/issues\">here</a></p>\n</div>\n\n**Links**\n\n* [Overview/Explanation of the Dashboard](https://bardos.dev/e-scooter-dashboard-overview.html)\n* [Transformation: code & documentation](https://github.com/fbardos/shared_mobility_wthur)\n\n**Info**\n\n* Data source: [BFE Shared Mobility](https://opendata.swiss/dataset/standorte-und-verfugbarkeit-von-shared-mobility-angeboten)\n* Data collected every 2 minutes\n* Data calculation: every day at 02:00 UTC\n* Time window: Data is kept for 365 days, then deleted",
        "mode": "markdown"
      },
      "pluginVersion": "10.0.1",
      "type": "text"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the amount of different scooter IDs, on average, in selected time window. Does not distinguish between scooters available for renting or currently on a trip.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 600
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 11,
        "y": 1
      },
      "id": 2,
      "options": {
        "colorMode": "none",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "mean"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "select\n\tEXTRACT(EPOCH from time) as time\n\t, SUM(count_available) as count_ids\nfrom shared_mobility_provider\nWHERE\n\t$__timeFilter(time)\nGROUP BY time\nORDER BY time",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Scooters (mean)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Amount of trips in selected time window. Trip end time is determined to evaluate if shown in current time window or not.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 15,
        "y": 1
      },
      "id": 13,
      "options": {
        "colorMode": "none",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "select\n  EXTRACT(EPOCH FROM date_trunc('hour', trip_end)) as time\n  , count(*) as values\nfrom shared_mobility_mart_trip_distance\nWHERE\n  trip_walk_distance_m > 0\n  and $__timeFilter(trip_end)\nGROUP BY time\nORDER BY time",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trips (sum)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Average drip distance per trip. Individual trips are first put into a hourly bin, then an average is calcuted. After that, another average is calculated for the whole time window out of these hourly bins.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": null
              }
            ]
          },
          "unit": "lengthm"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 19,
        "y": 1
      },
      "id": 3,
      "options": {
        "colorMode": "none",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "mean"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.0.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "select\n\tEXTRACT(EPOCH FROM date_trunc('hour', trip_end)) as time\n\t, AVG(trip_walk_distance_m) as values\nfrom shared_mobility_mart_trip_distance\nwhere\n\t$__timeFilter(trip_end)\nGROUP BY time\nORDER BY time",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trip Distance (mean)",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 9
      },
      "id": 17,
      "panels": [],
      "title": "Stationary Scooter",
      "type": "row"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Show the counted scooter IDs per provider and 2 minute time window. Does only list scooters who are available for rental.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "area"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 150
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 11,
        "x": 0,
        "y": 10
      },
      "id": 19,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  provider,\n  extract(EPOCH from \"time\") as time,\n  SUM(count_available)\nFROM shared_mobility_provider\nWHERE\n  $__timeFilter(time)\nGROUP BY provider, time\nORDER BY 2, 1",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Available scooter per provider (count)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows stationary scooter positions on a map, in the given time window. The longer the scooter stands on this position, the higher the weight. More weight means a more \"redish\" color on the map.\nStay duration to time window mapping: A particular, staying scooter is added to the chart when both start and end time of the stationary time frame are inside the selected time window on the dashboard.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 17,
        "w": 13,
        "x": 11,
        "y": 10
      },
      "id": 20,
      "options": {
        "basemap": {
          "config": {},
          "name": "Layer 0",
          "opacity": 0.4,
          "tooltip": false,
          "type": "osm-standard"
        },
        "controls": {
          "mouseWheelZoom": true,
          "showAttribution": true,
          "showDebug": false,
          "showMeasure": false,
          "showScale": false,
          "showZoom": true
        },
        "layers": [
          {
            "config": {
              "blur": 15,
              "radius": 15,
              "weight": {
                "field": "time_stayed_hours",
                "fixed": 1,
                "max": 1,
                "min": 0
              }
            },
            "filterData": {
              "id": "byRefId",
              "options": "A"
            },
            "location": {
              "mode": "auto"
            },
            "name": "Layer 1",
            "opacity": 1,
            "tooltip": true,
            "type": "heatmap"
          }
        ],
        "tooltip": {
          "mode": "details"
        },
        "view": {
          "allLayers": true,
          "id": "coords",
          "lat": 47.498562,
          "lon": 8.73711,
          "zoom": 14.17
        }
      },
      "pluginVersion": "10.0.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n    extract(EPOCH from time_to) as time\n    , EXTRACT(EPOCH FROM time_to - time_from) / 3600 as time_stayed_hours\n    , ST_X(point) as lon\n    , ST_Y(point) as lat\nFROM shared_mobility_path\nWHERE\n  not moving\n  and time_from >= $__timeFrom()\n  and time_to <= $__timeTo()\nORDER BY time",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Stationary Scooter Position",
      "type": "geomap"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the average duration, a scooter stays on the same position in bins of 24 hours. A bin starts at 00:00 and ends at 23:59:59. The lower the value, the more active the scooters of this provider is. The avarage is only calculated for scooters, whose ID was first first seen before time bin and last seen after time bin.\nIn reality, scooter staying duration should be higher. But because data gets collected every 2 minutes, scooters which get used alot will add some time uncertanty at begining and end of a trip and therefore show lower staying durations.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 11,
        "x": 0,
        "y": 19
      },
      "id": 21,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n\tt + INTERVAL '12 hours' as time\n\t, pat.provider\n\t, AVG(EXTRACT(EPOCH FROM (LEAST(time_to, t + INTERVAL '1 day') - GREATEST(time_from, t)))) as avg_wait_duration_seconds\nFROM shared_mobility_path pat\n\tCROSS JOIN generate_series(date_trunc('day', time_from), date_trunc('day', time_to), INTERVAL '1 day') g(t)\n\tJOIN shared_mobility_ids ids on pat.id = ids.id\nWHERE\n\tNOT moving\n\tAND time_from < $__timeTo() \n\tAND time_to > $__timeFrom()\n\tAND ids.first_seen < t\n\tAND ids.last_seen > t + INTERVAL '1 day'\nGROUP BY time, pat.provider",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Staying duration per day (mean)",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 27
      },
      "id": 16,
      "panels": [],
      "title": "Moving Scooter",
      "type": "row"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows trip end (hour, rounded down) on the X-Axis and the average trip distance (metric) on the Y-Axis. The different bubbles are different days (Mon-Sun). The size of the bubble represents the amount of trips performed.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-green",
            "mode": "fixed"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "scaleDistribution": {
              "type": "linear"
            },
            "show": "points"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 11,
        "x": 0,
        "y": 28
      },
      "id": 10,
      "options": {
        "dims": {
          "exclude": [],
          "frame": 0,
          "x": "trip_end_hour"
        },
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": false
        },
        "series": [
          {
            "pointColor": {
              "fixed": "dark-green"
            },
            "pointSize": {
              "field": "sum_trips",
              "fixed": 8,
              "max": 18,
              "min": 2
            },
            "x": "trip_end_hour",
            "y": "avg_distance_m"
          }
        ],
        "seriesMapping": "manual",
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.0.1",
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "SELECT\n\tCONCAT(EXTRACT(isodow from trip_end::date)::text, ' - ', to_char(trip_end, 'Day')) as trip_end_weekday\n\t, extract(hour from trip_end) as trip_end_hour\n\t, AVG(trip_walk_distance_m) as avg_distance_m\n\t, count(*) as sum_trips\nFROM shared_mobility_mart_trip_distance\nWHERE \n  $__timeFilter(trip_end)\nGROUP BY trip_end_weekday, trip_end_hour\nORDER BY trip_end_hour",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trip distance (meter) per day and time (hour)",
      "transformations": [
        {
          "disabled": true,
          "id": "partitionByValues",
          "options": {
            "fields": [
              "trip_end_weekday"
            ]
          }
        }
      ],
      "type": "xychart"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the travel routes of all trips in a given time window. The more trips are passing a certain route, the more \"redish\" the line becomes. The paths are calculated using OpenStreetmap nodes for walking. Another option would be to calculate a path for nodes with a bike. There are no nodes for scooters. During transformation, the color of the line gets calculated normalized. Therefore, when selecting different dashboard time windows, the same line color can not be compared to to other line colors of another time window.",
      "gridPos": {
        "h": 14,
        "w": 13,
        "x": 11,
        "y": 28
      },
      "id": 6,
      "options": {
        "basemap": {
          "config": {},
          "type": "default"
        },
        "dataLayer": {
          "config": {
            "jitterPoints": false
          },
          "location": {
            "geohash": "geohash",
            "mode": "geohash"
          },
          "metricName": "weight",
          "parentName": "geohash_before",
          "type": "markers"
        },
        "globalThresholdsConfig": [
          {
            "color": "rgb(55, 135, 45)",
            "label": "",
            "lineWidth": 0.5,
            "selColor": "rgb(55, 135, 45)",
            "value": 0
          },
          {
            "color": "rgb(224, 180, 0)",
            "label": "",
            "lineWidth": 1,
            "selColor": "rgb(224, 180, 0)",
            "value": 0.1
          },
          {
            "color": "rgb(250, 100, 0)",
            "label": "",
            "lineWidth": 1.5,
            "selColor": "rgb(250, 100, 0)",
            "value": 0.3
          },
          {
            "color": "rgb(196, 22, 42)",
            "label": "",
            "lineWidth": 2,
            "selColor": "rgb(196, 22, 42)",
            "value": 0.5
          }
        ],
        "view": {
          "id": "coords",
          "lat": 47.499379,
          "lon": 8.735499,
          "zoom": 12.49
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "CREATE TEMP TABLE t1 ON COMMIT DROP AS\n  select\n      ST_GeoHash(\"point\") as geohash,\n      ST_GeoHash(point_before) as geohash_before,\n      count(*)::float as weight\n    from shared_mobility_mart_edges\n    WHERE\n      time_to >= $__timeFrom()\n      and time_from <= $__timeTo()\n  group by geohash, geohash_before;\n\nselect\n  geohash,\n  geohash_before,\n  (weight - (SELECT min(weight) from t1)) / ((SELECT max(weight) from t1) - (select min(weight) from t1)) as weight\nfrom t1 \nWHERE\n  t1.weight > 2\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Travel Routes",
      "type": "vaduga-mapgl-panel"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the amont of trips performed on a given day. The end time of a trip is put in a bin of 24 hours (00:00:00 to 23:59:59) and then counted, per provider.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 11,
        "x": 0,
        "y": 35
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "select\n  EXTRACT(EPOCH FROM date_trunc('day', trip_end)) as time\n  , provider as values\n  , count(*) as count_trips\nfrom shared_mobility_mart_trip_distance\nWHERE\n  trip_walk_distance_m > 0\n  and $__timeFilter(trip_end)\nGROUP BY time, provider\nORDER BY time, provider",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trips per day (count)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the amont of trips performed on a given hour. The end time of a trip is put in a bin of 60 minutes (00:00 to 59:59) and then counted, per provider.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 24,
        "x": 0,
        "y": 42
      },
      "id": 18,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "select\n  EXTRACT(EPOCH FROM date_trunc('hour', trip_end)) as time\n  , provider as values\n  , count(*) as count_trips\nfrom shared_mobility_mart_trip_distance\nWHERE\n  trip_walk_distance_m > 0\n  and $__timeFilter(trip_end)\nGROUP BY time, provider\nORDER BY time, provider",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trips per hour (count)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows a histogram concerning the trip distance (metric) of all trips performed in a selected time window. The end time of a trip is crucial for selection into the dashboard's time window.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "purple",
            "mode": "fixed"
          },
          "custom": {
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "lengthm"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 49
      },
      "id": 11,
      "options": {
        "bucketOffset": 0,
        "bucketSize": 100,
        "combine": false,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "table",
          "rawQuery": true,
          "rawSql": "select trip_walk_distance_m\nfrom shared_mobility_mart_trip_distance\nwhere \n  trip_walk_distance_m IS NOT NULL\n  and $__timeFilter(trip_end)",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Trip Distance, Histogram",
      "type": "histogram"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 57
      },
      "id": 15,
      "panels": [],
      "title": "Data Quality",
      "type": "row"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the time difference between the API extraction time and the information inside the returned data from the API, when the data was last updated. This is calculated per provider.\nThe higher the time distance is, the less accurate a trip can be calculated. When time difference exceeds 10 minutes, the data gets not updated as regularly as intended.\nWhen the time difference rises for all the provider (and not just for one provder), this indicates, that either the BFE API or my collecting task were down or malfunctioning during that time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "log": 2,
              "type": "symlog"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "area"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 180
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 58
      },
      "id": 8,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  provider,\n  extract(EPOCH from \"time\") as time,\n  AVG(avg_delta_updated / 1000000000) \nFROM shared_mobility_provider\nWHERE\n  $__timeFilter(time)\nGROUP BY provider, time\nORDER BY 2 asc",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Time since last update (mean)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "postgres",
        "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
      },
      "description": "Shows the average age of a scooter over time. As long as the average age raises over time, the calculation of paths can be performed more correctly. When the average age of scooter stays the same or even decreases, this can be an indicator, that scooter trips cannot be performed correctly. In this case, the moving scooter section has be looked ad with caution.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "area"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "orange",
                "value": 1
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 58
      },
      "id": 9,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "postgres",
            "uid": "${DS_POSTGIS_SHARED_MOBILITY}"
          },
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  EXTRACT(EPOCH FROM date_trunc('hour', x)) as time\n  , provider\n  , AVG(EXTRACT(EPOCH from x - first_seen)) as avg_age_seconds\nFROM shared_mobility_ids\n  CROSS JOIN generate_series(first_seen, last_seen, interval '1 hour') t(x)\nWHERE\n  first_seen < $__timeTo()\n  AND last_seen > $__timeFrom()\nGROUP BY time, provider\n\n\n",
          "refId": "A",
          "sql": {
            "columns": [
              {
                "parameters": [],
                "type": "function"
              }
            ],
            "groupBy": [
              {
                "property": {
                  "type": "string"
                },
                "type": "groupBy"
              }
            ],
            "limit": 50
          }
        }
      ],
      "title": "Age Scooter ID (mean)",
      "type": "timeseries"
    }
  ],
  "refresh": "",
  "schemaVersion": 38,
  "style": "dark",
  "tags": [],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-7d",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "1d"
    ]
  },
  "timezone": "utc",
  "title": "BFE E-Scooter Winterthur",
  "uid": "scooter_winterthur",
  "version": 40,
  "weekStart": "monday"
}